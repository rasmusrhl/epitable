---
title: "epitable"
author: "Rasmus Larsen"
date: "`r Sys.Date()`"
output:
  html_document:
    css: null
    theme: null
vignette: >
  %\VignetteIndexEntry{epitable_vignette}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
---
```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(epitable)
library(dplyr)
```

## freq_by
The `freq_by`-function creates a frequency and percentage table commonly used in
epidemiological papers. It is a wrapper for the [htmlTables-package](https://cran.r-project.org/package=htmlTable).

```{r}
head(example_data)
```

Counts and frequencies of the variables `color`and `clarity` grouped by `cut` is obtained below:
```{r, echo=TRUE, results='asis'}
freq_by(dataset = example_data, var_vector = c("color", "clarity"), by_group = "cut" )
```

The `by_group` variable must be of class factor, to ensure correct order.  

## model_to_html

The `model_to_html`-function can print simple models to HTML, also printing the reference levels of the categorical covariates.

```{r, results='asis'}
 df         <- survival::lung
 df$age_bin <- Hmisc::cut2( df$age, g = 5)
 df$ph_bin  <- Hmisc::cut2( df$ph.karno, g = 5)
 df$sex     <- factor( df$sex)
 model1      <- survival::coxph( survival::Surv( time = time, event = status==1) ~ age_bin + factor(sex) + ph_bin + wt.loss, data = df )

 model_to_html(model1, exponentiate = TRUE )
```




```{r}
# 
#  diamonds <- ggplot2::diamonds
#  diamonds$color <- factor(diamonds$color, ordered = FALSE)
#  diamonds$clarity <- factor(diamonds$clarity, ordered = FALSE)
#  glm_logistic <- glm( cut=="Ideal" ~  color + clarity + x , data = diamonds, family = "binomial")
#  glm_linear <- glm( Sepal.Width ~  Petal.Width + Species, data = iris)

```










To do in a possible future:

* Add totals to each of the `by_group`s
* option to specify better names to the rgroup, not just the variable names.
* function for adding reference levels to regression models.
* include other summary statistics
* option to render blank cells containing few observations, to ensure anonymity.

The output is a HTML-table created by the htmlTable-package. The HTML-output 
looks best if no CSS is used.







